<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="theme-color" content="#2563eb">
    <link rel="apple-touch-icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><rect fill='%232563eb' width='100' height='100'/><text y='75' font-size='70' fill='white' text-anchor='middle' x='50'>‚öΩ</text></svg>">
    <link rel="manifest" href="data:application/json;base64,eyJuYW1lIjoiRXVyb3BlYW4gRm9vdGJhbGwgU3RhdHMiLCJzaG9ydF9uYW1lIjoiRm9vdGJhbGwgU3RhdHMiLCJzdGFydF91cmwiOiIvIiwiZGlzcGxheSI6InN0YW5kYWxvbmUiLCJiYWNrZ3JvdW5kX2NvbG9yIjoiI2ZmZmZmZiIsInRoZW1lX2NvbG9yIjoiIzI1NjNlYiIsImlkb25zIjpbeyJzcmMiOiJkYXRhOmltYWdlL3N2Zyt4bWwsPHN2ZyB4bWxucz0naHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnIHZpZXdCb3g9JzAgMCAxMDAgMTAwJz48cmVjdCBmaWxsPSclMjMyNTYzZWInIHdpZHRoPScxMDAnIGhlaWdodD0nMTAwJy8+PHRleHQgeT0nNzUnIGZvbnQtc2l6ZT0nNzAnIGZpbGw9J3doaXRlJyB0ZXh0LWFuY2hvcj0nbWlkZGxlJyB4PSc1MCc+4pq94L2QPC90ZXh0Pjwvc3ZnPiIsInNpemVzIjoiNTEyeDUxMiIsInR5cGUiOiJpbWFnZS9zdmcreG1sIn1dfQ==">
    <title>Football Stats</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        * {
            -webkit-tap-highlight-color: transparent;
        }
        body {
            overscroll-behavior-y: contain;
            touch-action: pan-y;
        }
        .safe-area {
            padding-top: env(safe-area-inset-top);
            padding-bottom: env(safe-area-inset-bottom);
        }
        @supports (orientation: landscape) {
            @media (orientation: landscape) {
                .landscape-grid {
                    display: grid;
                    grid-template-columns: repeat(2, 1fr);
                    gap: 1rem;
                }
            }
        }
        .offline-banner {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        .stat-pill {
            display: inline-flex;
            align-items: center;
            padding: 0.25rem 0.5rem;
            border-radius: 0.5rem;
            font-size: 0.75rem;
            font-weight: 600;
        }
        .compact-stat {
            min-width: 0;
            flex: 1;
        }
    </style>
</head>
<body class="bg-gradient-to-br from-blue-50 to-indigo-100 min-h-screen safe-area">
    <div id="root"></div>

    <script type="text/babel" data-type="module">
        const { useState, useEffect } = React;

        const FootballPWA = () => {
            const [selectedLeague, setSelectedLeague] = useState('epl');
            const [isOnline, setIsOnline] = useState(navigator.onLine);
            const [installPrompt, setInstallPrompt] = useState(null);
            const [expandedMatch, setExpandedMatch] = useState(null);

            useEffect(() => {
                const handleOnline = () => setIsOnline(true);
                const handleOffline = () => setIsOnline(false);
                
                window.addEventListener('online', handleOnline);
                window.addEventListener('offline', handleOffline);

                const handleInstall = (e) => {
                    e.preventDefault();
                    setInstallPrompt(e);
                };
                window.addEventListener('beforeinstallprompt', handleInstall);

                return () => {
                    window.removeEventListener('online', handleOnline);
                    window.removeEventListener('offline', handleOffline);
                    window.removeEventListener('beforeinstallprompt', handleInstall);
                };
            }, []);

            const handleInstallClick = async () => {
                if (!installPrompt) return;
                installPrompt.prompt();
                const { outcome } = await installPrompt.userChoice;
                setInstallPrompt(null);
            };

            // Calculate comprehensive goal statistics
            const calculateGoalStats = (matches) => {
                const totalMatches = matches.length;
                let btts = 0;
                let over25 = 0;
                let totalGoalsScored = 0;
                let totalGoalsConceded = 0;

                matches.forEach(match => {
                    const [homeGoals, awayGoals] = match.score.split('-').map(Number);
                    const totalGoals = homeGoals + awayGoals;
                    
                    const teamGoals = match.venue === 'home' ? homeGoals : awayGoals;
                    const opponentGoals = match.venue === 'home' ? awayGoals : homeGoals;
                    
                    if (totalGoals > 2.5) over25++;
                    if (homeGoals > 0 && awayGoals > 0) btts++;
                    
                    totalGoalsScored += teamGoals;
                    totalGoalsConceded += opponentGoals;
                });

                return {
                    btts: Math.round((btts / totalMatches) * 100),
                    over25: Math.round((over25 / totalMatches) * 100),
                    avgScored: (totalGoalsScored / totalMatches).toFixed(1),
                    avgConceded: (totalGoalsConceded / totalMatches).toFixed(1),
                };
            };

            const leagues = {
                epl: {
                    name: 'Premier League',
                    flag: 'üè¥Û†ÅßÛ†Å¢Û†Å•Û†ÅÆÛ†ÅßÛ†Åø',
                    matches: [
                        {
                            id: 1,
                            home: 'Arsenal',
                            away: 'Man City',
                            homeScore: 2,
                            awayScore: 1,
                            status: 'final',
                            date: 'Feb 14',
                            homeForm: { 
                                overall: 'WWDWW', 
                                home: 'WWWDW', 
                                lastFive: [
                                    { vs: 'Chelsea', score: '3-1', result: 'W', venue: 'home' },
                                    { vs: 'Liverpool', score: '2-2', result: 'D', venue: 'home' },
                                    { vs: 'Spurs', score: '2-0', result: 'W', venue: 'home' },
                                    { vs: 'Brighton', score: '3-0', result: 'W', venue: 'home' },
                                    { vs: 'Everton', score: '4-0', result: 'W', venue: 'home' }
                                ]
                            },
                            awayForm: { 
                                overall: 'WWLWW', 
                                away: 'WWLWL', 
                                lastFive: [
                                    { vs: 'Newcastle', score: '2-1', result: 'W', venue: 'away' },
                                    { vs: 'Aston Villa', score: '1-3', result: 'L', venue: 'away' },
                                    { vs: 'Wolves', score: '3-0', result: 'W', venue: 'away' },
                                    { vs: 'West Ham', score: '2-1', result: 'W', venue: 'away' },
                                    { vs: 'Fulham', score: '1-2', result: 'L', venue: 'away' }
                                ]
                            },
                        },
                        {
                            id: 2,
                            home: 'Liverpool',
                            away: 'Chelsea',
                            homeScore: 3,
                            awayScore: 2,
                            status: 'final',
                            date: 'Feb 15',
                            homeForm: { 
                                overall: 'WWWWL', 
                                home: 'WWWWW', 
                                lastFive: [
                                    { vs: 'Man United', score: '4-1', result: 'W', venue: 'home' },
                                    { vs: 'Brighton', score: '2-0', result: 'W', venue: 'home' },
                                    { vs: 'Newcastle', score: '3-1', result: 'W', venue: 'home' },
                                    { vs: 'Aston Villa', score: '2-1', result: 'W', venue: 'home' },
                                    { vs: 'Spurs', score: '3-0', result: 'W', venue: 'home' }
                                ]
                            },
                            awayForm: { 
                                overall: 'LWWDW', 
                                away: 'LWWDL', 
                                lastFive: [
                                    { vs: 'Arsenal', score: '1-2', result: 'L', venue: 'away' },
                                    { vs: 'Fulham', score: '1-1', result: 'D', venue: 'away' },
                                    { vs: 'Everton', score: '2-0', result: 'W', venue: 'away' },
                                    { vs: 'Wolves', score: '3-1', result: 'W', venue: 'away' },
                                    { vs: 'West Ham', score: '0-2', result: 'L', venue: 'away' }
                                ]
                            },
                        },
                        {
                            id: 3,
                            home: 'Man United',
                            away: 'Tottenham',
                            homeScore: null,
                            awayScore: null,
                            status: 'upcoming',
                            date: 'Feb 16',
                            homeForm: { 
                                overall: 'WDLWW', 
                                home: 'WWDWL', 
                                lastFive: [
                                    { vs: 'Newcastle', score: '3-2', result: 'W', venue: 'home' },
                                    { vs: 'Aston Villa', score: '1-2', result: 'L', venue: 'home' },
                                    { vs: 'Wolves', score: '2-2', result: 'D', venue: 'home' },
                                    { vs: 'Everton', score: '2-0', result: 'W', venue: 'home' },
                                    { vs: 'Brighton', score: '3-1', result: 'W', venue: 'home' }
                                ]
                            },
                            awayForm: { 
                                overall: 'DWWLW', 
                                away: 'DLWWL', 
                                lastFive: [
                                    { vs: 'Liverpool', score: '1-4', result: 'L', venue: 'away' },
                                    { vs: 'Chelsea', score: '2-1', result: 'W', venue: 'away' },
                                    { vs: 'Arsenal', score: '2-1', result: 'W', venue: 'away' },
                                    { vs: 'Man City', score: '1-1', result: 'D', venue: 'away' },
                                    { vs: 'West Ham', score: '0-2', result: 'L', venue: 'away' }
                                ]
                            },
                        }
                    ]
                },
                laliga: {
                    name: 'La Liga',
                    flag: 'üá™üá∏',
                    matches: [
                        {
                            id: 4,
                            home: 'Real Madrid',
                            away: 'Barcelona',
                            homeScore: null,
                            awayScore: null,
                            status: 'upcoming',
                            date: 'Feb 16',
                            homeForm: { 
                                overall: 'WWWWW', 
                                home: 'WWWWW', 
                                lastFive: [
                                    { vs: 'Sevilla', score: '3-0', result: 'W', venue: 'home' },
                                    { vs: 'Atletico', score: '2-1', result: 'W', venue: 'home' },
                                    { vs: 'Valencia', score: '4-1', result: 'W', venue: 'home' },
                                    { vs: 'Getafe', score: '2-0', result: 'W', venue: 'home' },
                                    { vs: 'Villarreal', score: '3-1', result: 'W', venue: 'home' }
                                ]
                            },
                            awayForm: { 
                                overall: 'WWDWW', 
                                away: 'WWDWL', 
                                lastFive: [
                                    { vs: 'Athletic', score: '1-2', result: 'L', venue: 'away' },
                                    { vs: 'Real Sociedad', score: '2-1', result: 'W', venue: 'away' },
                                    { vs: 'Betis', score: '1-1', result: 'D', venue: 'away' },
                                    { vs: 'Osasuna', score: '3-0', result: 'W', venue: 'away' },
                                    { vs: 'Girona', score: '2-1', result: 'W', venue: 'away' }
                                ]
                            },
                        },
                        {
                            id: 5,
                            home: 'Atletico Madrid',
                            away: 'Sevilla',
                            homeScore: 2,
                            awayScore: 1,
                            status: 'final',
                            date: 'Feb 14',
                            homeForm: { 
                                overall: 'WWDLW', 
                                home: 'WWWLW', 
                                lastFive: [
                                    { vs: 'Barcelona', score: '2-1', result: 'W', venue: 'home' },
                                    { vs: 'Valencia', score: '1-2', result: 'L', venue: 'home' },
                                    { vs: 'Betis', score: '3-0', result: 'W', venue: 'home' },
                                    { vs: 'Villarreal', score: '2-0', result: 'W', venue: 'home' },
                                    { vs: 'Athletic', score: '1-0', result: 'W', venue: 'home' }
                                ]
                            },
                            awayForm: { 
                                overall: 'LDWDL', 
                                away: 'LLDWL', 
                                lastFive: [
                                    { vs: 'Real Madrid', score: '0-3', result: 'L', venue: 'away' },
                                    { vs: 'Girona', score: '1-1', result: 'D', venue: 'away' },
                                    { vs: 'Osasuna', score: '2-1', result: 'W', venue: 'away' },
                                    { vs: 'Real Sociedad', score: '0-2', result: 'L', venue: 'away' },
                                    { vs: 'Getafe', score: '1-2', result: 'L', venue: 'away' }
                                ]
                            },
                        }
                    ]
                }
            };

            const currentMatches = leagues[selectedLeague].matches;

            const StatusBadge = ({ status }) => {
                if (status === 'final') return <span className="stat-pill bg-gray-700 text-white">FT</span>;
                if (status === 'upcoming') return <span className="stat-pill bg-blue-600 text-white">Upcoming</span>;
                return <span className="stat-pill bg-green-600 text-white">Live</span>;
            };

            const StatPill = ({ label, value, color = "gray" }) => (
                <div className={`stat-pill bg-${color}-100 text-${color}-700 border border-${color}-300`}>
                    <span className="opacity-75 mr-1">{label}:</span>
                    <span className="font-bold">{value}</span>
                </div>
            );

            const CompactMatchCard = ({ match }) => {
                const homeStats = calculateGoalStats(match.homeForm.lastFive);
                const awayStats = calculateGoalStats(match.awayForm.lastFive);
                const isExpanded = expandedMatch === match.id;

                return (
                    <div className="bg-white rounded-xl shadow-lg overflow-hidden">
                        {/* Match Header */}
                        <div className="p-4 border-b border-gray-200">
                            <div className="flex justify-between items-center mb-2">
                                <div className="text-xs text-gray-500">üìÖ {match.date}</div>
                                <StatusBadge status={match.status} />
                            </div>
                            
                            <div className="space-y-2">
                                <div className="flex items-center justify-between">
                                    <div className="font-bold text-gray-800">{match.home}</div>
                                    {match.status === 'final' && (
                                        <div className="text-xl font-bold text-blue-600">{match.homeScore}</div>
                                    )}
                                </div>
                                
                                <div className="flex items-center justify-between">
                                    <div className="font-bold text-gray-800">{match.away}</div>
                                    {match.status === 'final' && (
                                        <div className="text-xl font-bold text-blue-600">{match.awayScore}</div>
                                    )}
                                </div>
                            </div>
                        </div>

                        {/* Quick Stats - Always Visible */}
                        <div className="p-3 bg-gradient-to-r from-blue-50 to-indigo-50">
                            <div className="grid grid-cols-2 gap-3">
                                {/* Home Team Stats */}
                                <div className="space-y-1">
                                    <div className="text-xs font-semibold text-gray-600 mb-1.5">üè† {match.home}</div>
                                    <div className="flex flex-wrap gap-1">
                                        <StatPill label="Avg" value={homeStats.avgScored} color="green" />
                                        <StatPill label="O2.5" value={`${homeStats.over25}%`} color="blue" />
                                        <StatPill label="BTTS" value={`${homeStats.btts}%`} color="purple" />
                                    </div>
                                </div>

                                {/* Away Team Stats */}
                                <div className="space-y-1">
                                    <div className="text-xs font-semibold text-gray-600 mb-1.5">‚úàÔ∏è {match.away}</div>
                                    <div className="flex flex-wrap gap-1">
                                        <StatPill label="Avg" value={awayStats.avgScored} color="green" />
                                        <StatPill label="O2.5" value={`${awayStats.over25}%`} color="blue" />
                                        <StatPill label="BTTS" value={`${awayStats.btts}%`} color="purple" />
                                    </div>
                                </div>
                            </div>
                        </div>

                        {/* Expand Button */}
                        <button
                            onClick={() => setExpandedMatch(isExpanded ? null : match.id)}
                            className="w-full py-2 text-xs font-semibold text-blue-600 hover:bg-blue-50 transition-colors"
                        >
                            {isExpanded ? '‚ñ≤ Hide Details' : '‚ñº Show More Stats'}
                        </button>

                        {/* Expanded Details */}
                        {isExpanded && (
                            <div className="p-4 bg-gray-50 border-t border-gray-200 space-y-4">
                                {/* Home Team Detailed */}
                                <div>
                                    <div className="font-bold text-sm text-gray-700 mb-2">üè† {match.home} - Last 5 Home</div>
                                    <div className="grid grid-cols-2 gap-2 text-xs">
                                        <div className="bg-white p-2 rounded">
                                            <div className="text-gray-500">Avg Scored</div>
                                            <div className="text-lg font-bold text-green-600">{homeStats.avgScored}</div>
                                        </div>
                                        <div className="bg-white p-2 rounded">
                                            <div className="text-gray-500">Avg Conceded</div>
                                            <div className="text-lg font-bold text-red-600">{homeStats.avgConceded}</div>
                                        </div>
                                        <div className="bg-white p-2 rounded">
                                            <div className="text-gray-500">Over 2.5</div>
                                            <div className="text-lg font-bold text-blue-600">{homeStats.over25}%</div>
                                        </div>
                                        <div className="bg-white p-2 rounded">
                                            <div className="text-gray-500">BTTS</div>
                                            <div className="text-lg font-bold text-purple-600">{homeStats.btts}%</div>
                                        </div>
                                    </div>
                                    <div className="mt-2 text-xs text-gray-600">
                                        Form: {match.homeForm.home.split('').map((f, i) => (
                                            <span key={i} className={`inline-block w-5 h-5 text-center rounded ml-0.5 ${
                                                f === 'W' ? 'bg-green-500 text-white' : 
                                                f === 'D' ? 'bg-yellow-500 text-white' : 
                                                'bg-red-500 text-white'
                                            }`}>{f}</span>
                                        ))}
                                    </div>
                                </div>

                                {/* Away Team Detailed */}
                                <div>
                                    <div className="font-bold text-sm text-gray-700 mb-2">‚úàÔ∏è {match.away} - Last 5 Away</div>
                                    <div className="grid grid-cols-2 gap-2 text-xs">
                                        <div className="bg-white p-2 rounded">
                                            <div className="text-gray-500">Avg Scored</div>
                                            <div className="text-lg font-bold text-green-600">{awayStats.avgScored}</div>
                                        </div>
                                        <div className="bg-white p-2 rounded">
                                            <div className="text-gray-500">Avg Conceded</div>
                                            <div className="text-lg font-bold text-red-600">{awayStats.avgConceded}</div>
                                        </div>
                                        <div className="bg-white p-2 rounded">
                                            <div className="text-gray-500">Over 2.5</div>
                                            <div className="text-lg font-bold text-blue-600">{awayStats.over25}%</div>
                                        </div>
                                        <div className="bg-white p-2 rounded">
                                            <div className="text-gray-500">BTTS</div>
                                            <div className="text-lg font-bold text-purple-600">{awayStats.btts}%</div>
                                        </div>
                                    </div>
                                    <div className="mt-2 text-xs text-gray-600">
                                        Form: {match.awayForm.away.split('').map((f, i) => (
                                            <span key={i} className={`inline-block w-5 h-5 text-center rounded ml-0.5 ${
                                                f === 'W' ? 'bg-green-500 text-white' : 
                                                f === 'D' ? 'bg-yellow-500 text-white' : 
                                                'bg-red-500 text-white'
                                            }`}>{f}</span>
                                        ))}
                                    </div>
                                </div>
                            </div>
                        )}
                    </div>
                );
            };

            return (
                <div className="min-h-screen pb-6">
                    {/* Offline Banner */}
                    {!isOnline && (
                        <div className="offline-banner text-white p-3 text-center text-sm font-medium shadow-lg">
                            üì° Offline Mode
                        </div>
                    )}

                    {/* Install Banner */}
                    {installPrompt && (
                        <div className="bg-gradient-to-r from-blue-600 to-indigo-600 text-white p-3 shadow-lg">
                            <div className="flex items-center justify-between max-w-4xl mx-auto px-2">
                                <div className="flex-1 min-w-0">
                                    <p className="font-semibold text-sm">Install Football Stats</p>
                                    <p className="text-xs opacity-90">Quick access from home screen</p>
                                </div>
                                <button
                                    onClick={handleInstallClick}
                                    className="ml-3 px-3 py-1.5 bg-white text-blue-600 rounded-lg font-semibold text-sm shadow-md active:scale-95 transition-transform flex-shrink-0"
                                >
                                    Install
                                </button>
                            </div>
                        </div>
                    )}

                    <div className="max-w-4xl mx-auto px-3 pt-4">
                        {/* Header */}
                        <div className="bg-white rounded-2xl shadow-xl p-4 mb-4">
                            <div className="flex items-center gap-2 mb-3">
                                <div className="text-2xl">‚öΩ</div>
                                <h1 className="text-xl font-bold text-gray-800">Football Stats</h1>
                            </div>
                            
                            {/* League Selector */}
                            <div className="flex gap-2">
                                <button
                                    onClick={() => setSelectedLeague('epl')}
                                    className={`flex-1 px-3 py-2 rounded-xl font-semibold text-sm transition-all active:scale-95 ${
                                        selectedLeague === 'epl'
                                            ? 'bg-blue-600 text-white shadow-lg'
                                            : 'bg-gray-100 text-gray-700'
                                    }`}
                                >
                                    {leagues.epl.flag} EPL
                                </button>
                                <button
                                    onClick={() => setSelectedLeague('laliga')}
                                    className={`flex-1 px-3 py-2 rounded-xl font-semibold text-sm transition-all active:scale-95 ${
                                        selectedLeague === 'laliga'
                                            ? 'bg-blue-600 text-white shadow-lg'
                                            : 'bg-gray-100 text-gray-700'
                                    }`}
                                >
                                    {leagues.laliga.flag} La Liga
                                </button>
                            </div>
                        </div>

                        {/* Legend */}
                        <div className="bg-white rounded-xl shadow-md p-3 mb-4 text-xs">
                            <div className="font-semibold text-gray-700 mb-2">üìä Quick Stats Guide:</div>
                            <div className="grid grid-cols-3 gap-2">
                                <div><span className="font-bold">Avg</span> - Goals per game</div>
                                <div><span className="font-bold">O2.5</span> - Over 2.5 goals %</div>
                                <div><span className="font-bold">BTTS</span> - Both teams score %</div>
                            </div>
                        </div>

                        {/* Matches Grid - Responsive for landscape */}
                        <div className="landscape-grid space-y-4">
                            {currentMatches.map((match) => (
                                <CompactMatchCard key={match.id} match={match} />
                            ))}
                        </div>
                    </div>
                </div>
            );
        };

        ReactDOM.render(<FootballPWA />, document.getElementById('root'));
    </script>

    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <script>
        // Service Worker for offline support
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                const swCode = `
                    const CACHE_NAME = 'football-stats-v4';
                    const urlsToCache = ['/'];
                    
                    self.addEventListener('install', event => {
                        event.waitUntil(
                            caches.open(CACHE_NAME)
                                .then(cache => cache.addAll(urlsToCache))
                        );
                    });
                    
                    self.addEventListener('fetch', event => {
                        event.respondWith(
                            caches.match(event.request)
                                .then(response => response || fetch(event.request))
                        );
                    });
                `;
                
                const blob = new Blob([swCode], { type: 'application/javascript' });
                const swUrl = URL.createObjectURL(blob);
                
                navigator.serviceWorker.register(swUrl)
                    .then(reg => console.log('Service Worker registered'))
                    .catch(err => console.log('Service Worker registration failed:', err));
            });
        }
    </script>
</body>
</html>